{"version":3,"file":"1.chunk.js","sources":["webpack:///./wechat-react/components/page/index.js","webpack:///./wechat-react/mine/actions/camp.js"],"sourcesContent":["import React, {\r\n    PureComponent, Fragment\r\n} from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// import { getRouter } from '../../containers/app';\r\nimport Detect from '../detect';\r\n\r\n/**\r\n * 用于修改网页标题和 body class 等\r\n */\r\nclass Page extends PureComponent {\r\n\r\n    componentWillMount() {\r\n        // this.reconfigWx();\r\n        recordRouteHistory();\r\n    }\r\n\r\n    componentDidMount() {\r\n        const {title, cs, banpv=false, description, keyword} = this.props;\r\n        console.log(this.props)\r\n\r\n        this.setClass(cs);\r\n        this.setTitle(title);\r\n        this.setMeta('description', description)\r\n        this.setMeta('keyword', keyword)\r\n        if(!banpv) setTimeout(() => {\r\n            this.pvLog();\r\n        }, 0);\r\n\r\n    }\r\n\r\n    pvLog() {\r\n\r\n        // let router = getRouter();\r\n\r\n        // if (router && router.location && router.location.action === 'PUSH') {\r\n        typeof _qla != 'undefined' && _qla('pv', {\r\n\r\n        });\r\n        // }\r\n    }\r\n\r\n    reconfigWx() {\r\n        let wxConfig = document.querySelector('#wxConfig');\r\n        if (wxConfig) {\r\n            wxConfig.parentNode.removeChild(wxConfig);\r\n        }\r\n\r\n        const script = document.createElement('script');\r\n        script.id = 'wxConfig';\r\n        script.src = `/api/js-sdk/wx?actions=hide_all&${Date.now()}`;\r\n        document.body.appendChild(script);\r\n\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps) {\r\n        const {\r\n            title,\r\n            cs,\r\n            description,\r\n            keyword\r\n        } = this.props;\r\n        if (nextProps.title !== title) {\r\n            this.setTitle(nextProps.title)\r\n        }\r\n\r\n        if (nextProps.cs !== cs) {\r\n            this.setClass(nextProps.cs);\r\n        }\r\n\r\n        if (nextProps.description !== description) {\r\n            this.setMeta('description', nextProps.description)\r\n        }\r\n        if (nextProps.keyword !== keyword) {\r\n            this.setMeta('keyword', nextProps.keyword)\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        const {\r\n            title,\r\n            cs\r\n        } = this.props;\r\n\r\n        this.removeClass(cs);\r\n    }\r\n\r\n    setTitle(title) {\r\n        if (title) {\r\n            document.title = title;\r\n        }\r\n\r\n        // Magic iPhone 微信需要通过加载 iframe 来刷新 title\r\n        if (Detect.os.ios && Detect.os.weixin) {\r\n            var iframe = document.createElement(\"iframe\");\r\n            iframe.setAttribute(\"src\", \"/favicon.ico\");\r\n            iframe.style.display = 'none';\r\n            iframe.addEventListener('load', function() {\r\n                setTimeout(function() {\r\n                    //iframe.removeEventListener('load');\r\n                    document.body.removeChild(iframe);\r\n                }, 0);\r\n            });\r\n            document.body.appendChild(iframe);\r\n        }\r\n    }\r\n\r\n    setMeta (name, content) {\r\n        if (!name || !content) return\r\n        let meta = document.querySelector(`meta[name='${name}']`)\r\n        if (!meta) {\r\n            meta = document.createElement('meta');\r\n            document.getElementsByTagName('head')[0].appendChild(meta);\r\n        }\r\n        meta.content = content;\r\n        meta.name = name;\r\n    }\r\n\r\n    setClass(cs) {\r\n        if (cs) {\r\n            document.body.classList.add(cs);\r\n        }\r\n    }\r\n\r\n    removeClass(cs) {\r\n        if (cs) {\r\n            document.body.classList.remove(cs);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const {\r\n            component: Component,\r\n            cs,\r\n            title,\r\n            ...props\r\n        } = this.props;\r\n\r\n        return (\r\n            <Fragment>\r\n                <Component {...props} ref={el => (this.containerRef = el)}>\r\n                    {this.props.children}\r\n                </Component>\r\n                <div className=\"co-win-course-eval-container\"></div>\r\n            </Fragment>\r\n        )\r\n    }\r\n}\r\n\r\nPage.propTypes = {\r\n    component: PropTypes.any,\r\n    title: PropTypes.string,\r\n    description: PropTypes.string,\r\n    keyword: PropTypes.string,\r\n    cs: PropTypes.string,\r\n}\r\n\r\nPage.defaultProps = {\r\n    component: 'div',\r\n    title: '',\r\n    description: '',\r\n    keyword: '',\r\n    cs: '',\r\n}\r\n\r\nexport default Page;\r\n\r\n\r\n\r\n/**\r\n * 记录页面路由到sessionStorage\r\n * 相同url只记录一次，最大记录长度为2\r\n * \r\n * ！！！切记获取上一页url时要用相对index，避免以后修改最大长度\r\n */\r\nexport function recordRouteHistory() {\r\n    if (typeof location !== 'undefined' && typeof sessionStorage !== 'undefined') {\r\n        try {\r\n            const key = 'ROUTE_HISTORY';\r\n\r\n            let routes = JSON.parse(sessionStorage.getItem(key));\r\n            routes instanceof Array || (routes = []);\r\n\r\n            if (routes[routes.length - 1] != location.href) {\r\n                routes.push(location.href);\r\n                if (routes.length > 2) routes.shift();\r\n    \r\n                sessionStorage.setItem(key, JSON.stringify(routes));\r\n            }\r\n        } catch (e) {\r\n        }\r\n    }\r\n}","import { request } from 'common_actions/common'\r\n\r\n//请求验证码\r\nexport const sendValidCode = async (params) => {\r\n    const res = await request.post({\r\n        url: '/api/wechat/sendValidCode',\r\n        showLoading: false,\r\n        body: { ...params }\r\n    }).then(res => {\r\n        if (res.state && res.state.code !== 0) {\r\n            throw new Error(res.state.msg)\r\n        }\r\n        return res;\r\n    }).catch(err => {\r\n        window.toast(err.message);\r\n    })\r\n    return res \r\n}\r\n\r\n//校验验证码\r\nexport const checkoutCode = async (params) => {\r\n    const res = await request.post({\r\n        url: '/api/wechat/transfer/baseApi/h5/validCode/check',\r\n        body: { ...params }\r\n    }).then(res => {\r\n        if(res.state && res.state.code !== 0){\r\n            throw new Error(res.state.msg)\r\n        }\r\n        return res;\r\n    }).catch(err => {\r\n        window.toast(err.message);\r\n    }) \r\n    return res;\r\n}\r\n\r\n//注销账号\r\nexport const cancelId = async (params) => {\r\n    const res = await request.post({\r\n        url: '/api/wechat/transfer/baseApi/h5/user/invalidUser',\r\n        body: { ...params }\r\n    }).then(res => {\r\n        if(res.state && res.state.code !== 0){\r\n            throw new Error(res.state.msg)\r\n        }\r\n        return res;\r\n    }).catch(err => {\r\n        window.toast(err.message);\r\n    }) \r\n    return res;\r\n}\r\n\r\n//获取用户信息\r\nexport const userInfo = async (params) => {\r\n    const res = await request.post({\r\n        url: '/api/wechat/transfer/baseApi/h5/user/get',\r\n        body: { ...params }\r\n    }).then(res => {\r\n        if(res.state && res.state.code !== 0){\r\n            throw new Error(res.state.msg)\r\n        }\r\n        return res;\r\n    }).catch(err => {\r\n        window.toast(err.message);\r\n    }) \r\n    return res && res.data  || {};\r\n}"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AACA;AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;;;AAGA;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;;;AAEA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;AAEA;AAEA;AAEA;AACA;AAIA;;;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;;;AAEA;AAAA;AAAA;AAAA;AAMA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AACA;;;AAEA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AAOA;AAEA;AAAA;AAAA;AAAA;AAGA;AAAA;AAGA;;;;AAxIA;AACA;AA0IA;AACA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AACA;AACA;AACA;AACA;AALA;AAQA;AAIA;;;;;;;;;AAMA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;;;;;;;;;;;;;;;;;;;ACjMA;AACA;;;;;;;;;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAbA;AACA;AADA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AACA;;;AAeA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAZA;AACA;AADA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AACA;;;AAcA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAZA;AACA;AADA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AACA;;;AAcA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAZA;AACA;AADA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;;;;;A","sourceRoot":""}